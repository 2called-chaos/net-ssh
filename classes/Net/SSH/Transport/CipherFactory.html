<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Net::SSH::Transport::CipherFactory</title>
    <meta content='text/html; charset=US-ASCII' http-equiv='Content-Type'>
    <link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          Net::SSH::Transport::CipherFactory
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../../../files/lib/net/ssh/transport/cipher_factory_rb.html">lib/net/ssh/transport/cipher_factory.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Transport.html">Transport</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>Implements a factory of <a href="../../../OpenSSL.html">OpenSSL</a> cipher
            algorithms.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a target="docwin" href="#method-c-get">get</a></li>
              <li><a target="docwin" href="#method-c-get_lengths">get_lengths</a></li>
              <li><a target="docwin" href="#method-c-supported-3F">supported?</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>KEY_LEN_OVERRIDE</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      {
                      "arcfour256"                  => 32,
                      "arcfour512"                  => 64
                      }
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Ruby's <a href="../../../OpenSSL.html">OpenSSL</a> bindings always return a
                      key length of 16 for RC4 ciphers resulting in the error:
                      OpenSSL::CipherError: key length too short.  The following ciphers will
                      override this key length.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SSH_TO_OSSL</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      {
                      "3des-cbc"                    => "des-ede3-cbc",
                      "blowfish-cbc"                => "bf-cbc",
                      "aes256-cbc"                  => "aes-256-cbc",
                      "aes192-cbc"                  => "aes-192-cbc",
                      "aes128-cbc"                  => "aes-128-cbc",
                      "idea-cbc"                    => "idea-cbc",
                      "cast128-cbc"                 => "cast-cbc",
                      "rijndael-cbc@lysator.liu.se" => "aes-256-cbc",
                      "arcfour128"                  => "rc4",
                      "arcfour256"                  => "rc4",
                      "arcfour512"                  => "rc4",
                      "arcfour"                     => "rc4",
                      "camellia128-cbc"             => "camellia-128-cbc",
                      "camellia192-cbc"             => "camellia-192-cbc",
                      "camellia256-cbc"             => "camellia-256-cbc",
                      "camellia128-cbc@openssh.org" => "camellia-128-cbc",
                      "camellia192-cbc@openssh.org" => "camellia-192-cbc",
                      "camellia256-cbc@openssh.org" => "camellia-256-cbc",
                      
                      "3des-ctr"                    => "des-ede3",
                      "blowfish-ctr"                => "bf-ecb",
                      "aes256-ctr"                  => "aes-256-ecb",
                      "aes192-ctr"                  => "aes-192-ecb",
                      "aes128-ctr"                  => "aes-128-ecb",
                      "cast128-ctr"                 => "cast5-ecb",
                      "camellia128-ctr"             => "camellia-128-ecb",
                      "camellia192-ctr"             => "camellia-192-ecb",
                      "camellia256-ctr"             => "camellia-256-ecb",
                      "camellia128-ctr@openssh.org" => "camellia-128-ecb",
                      "camellia192-ctr@openssh.org" => "camellia-192-ecb",
                      "camellia256-ctr@openssh.org" => "camellia-256-ecb",
                      
                      "none"                        => "none",
                      }
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>Maps the <a href="../../SSH.html">SSH</a> name of a cipher to it's
                      corresponding <a href="../../../OpenSSL.html">OpenSSL</a> name</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-get'>
                <a name='method-c-get'></a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(name, options={})</span>
                </div>
                <div class='description'>
                  
                  <p>Retrieves a new instance of the named algorithm. The new instance will be
                  initialized using an iv and key generated from the given iv, key, shared,
                  hash and digester values. Additionally, the cipher will be put into
                  encryption or decryption mode, based on the value of the
                  <code>encrypt</code> parameter.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-get-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-get-source'><span class="ruby-comment"># File lib/net/ssh/transport/cipher_factory.rb, line 69</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>={})&#x000A;  <span class="ruby-identifier">ossl_name</span> = <span class="ruby-constant">SSH_TO_OSSL</span>[<span class="ruby-identifier">name</span>] <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-node">&quot;unimplemented cipher `#{name}'&quot;</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-constant">IdentityCipher</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ossl_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;none&quot;</span>&#x000A;  <span class="ruby-identifier">cipher</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ossl_name</span>)&#x000A;&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:encrypt</span>] <span class="ruby-operator">?</span> <span class="ruby-value">:encrypt</span> <span class="ruby-operator">:</span> <span class="ruby-value">:decrypt</span>)&#x000A;&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">padding</span> = <span class="ruby-value">0</span>&#x000A;&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Transport</span><span class="ruby-operator">::</span><span class="ruby-constant">CTR</span>) <span class="ruby-keyword">if</span> (<span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r-ctr(@openssh.org)?$/</span>)&#x000A;&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">iv</span>      = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Transport</span><span class="ruby-operator">::</span><span class="ruby-constant">KeyExpander</span>.<span class="ruby-identifier">expand_key</span>(<span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">iv_len</span>, <span class="ruby-identifier">options</span>[<span class="ruby-value">:iv</span>], <span class="ruby-identifier">options</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ossl_name</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;rc4&quot;</span>&#x000A;&#x000A;  <span class="ruby-identifier">key_len</span> = <span class="ruby-constant">KEY_LEN_OVERRIDE</span>[<span class="ruby-identifier">name</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">key_len</span>&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">key_len</span> = <span class="ruby-identifier">key_len</span>&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">key</span>     = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Transport</span><span class="ruby-operator">::</span><span class="ruby-constant">KeyExpander</span>.<span class="ruby-identifier">expand_key</span>(<span class="ruby-identifier">key_len</span>, <span class="ruby-identifier">options</span>[<span class="ruby-value">:key</span>], <span class="ruby-identifier">options</span>)&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">update</span>(<span class="ruby-string">&quot; &quot;</span> * <span class="ruby-value">1536</span>) <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ossl_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;rc4&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;arcfour&quot;</span>)&#x000A;&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-identifier">cipher</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-get_lengths'>
                <a name='method-c-get_lengths'></a>
                <div class='synopsis'>
                  <span class='name'>get_lengths</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a two-element array containing the [ key-length, block-size ] for
                  the named cipher algorithm. If the cipher algorithm is unknown, or is
                  "none", 0 is returned for both elements of the tuple.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-get_lengths-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-get_lengths-source'><span class="ruby-comment"># File lib/net/ssh/transport/cipher_factory.rb, line 94</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_lengths</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">ossl_name</span> = <span class="ruby-constant">SSH_TO_OSSL</span>[<span class="ruby-identifier">name</span>]&#x000A;  <span class="ruby-keyword">return</span> [<span class="ruby-value">0</span>, <span class="ruby-value">0</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">ossl_name</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">ossl_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;none&quot;</span>&#x000A;&#x000A;  <span class="ruby-identifier">cipher</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ossl_name</span>)&#x000A;  <span class="ruby-identifier">key_len</span> = <span class="ruby-constant">KEY_LEN_OVERRIDE</span>[<span class="ruby-identifier">name</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">key_len</span>&#x000A;  <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">key_len</span> = <span class="ruby-identifier">key_len</span>&#x000A;  &#x000A;  <span class="ruby-keyword">return</span> [<span class="ruby-identifier">key_len</span>, <span class="ruby-identifier">ossl_name</span><span class="ruby-operator">==</span><span class="ruby-string">&quot;rc4&quot;</span> <span class="ruby-operator">?</span> <span class="ruby-value">8</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">cipher</span>.<span class="ruby-identifier">block_size</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-method-c-supported-3F'>
                <a name='method-c-supported-3F'></a>
                <div class='synopsis'>
                  <span class='name'>supported?</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if the underlying <a href="../../../OpenSSL.html">OpenSSL</a>
                  library supports the given cipher, and false otherwise.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-supported-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-supported-3F-source'><span class="ruby-comment"># File lib/net/ssh/transport/cipher_factory.rb, line 58</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">supported?</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-identifier">ossl_name</span> = <span class="ruby-constant">SSH_TO_OSSL</span>[<span class="ruby-identifier">name</span>] <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-node">&quot;unimplemented cipher `#{name}'&quot;</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ossl_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;none&quot;</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span>.<span class="ruby-identifier">ciphers</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">ossl_name</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
