<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Net::SSH::Connection::Channel</title>
    <meta content='text/html; charset=US-ASCII' http-equiv='Content-Type'>
    <link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          Net::SSH::Connection::Channel
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../../../files/lib/net/ssh/connection/channel_rb.html">lib/net/ssh/connection/channel.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Connection.html">Connection</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>The channel abstraction. Multiple "channels" can be multiplexed onto a
            single <a href="../../SSH.html">SSH</a> channel, each operating
            independently and seemingly in parallel. This class represents a single
            such channel. Most operations performed with the <a
            href="../../SSH.html">Net::SSH</a> library will involve using one or more
            channels.</p>
            
            <p>Channels are intended to be used asynchronously. You request that one be
            opened (via <a
            href="Session.html#method-i-open_channel">Net::SSH::Connection::Session#open_channel</a>),
            and when it is opened, your callback is invoked. Then, you set various
            other callbacks on the newly opened channel, which are called in response
            to the corresponding events. Programming with <a
            href="../../SSH.html">Net::SSH</a> works best if you think of your programs
            as state machines. Complex programs are best implemented as objects that
            wrap a channel. See Net::SCP and Net::SFTP for examples of how complex
            state machines can be built on top of the <a href="../../SSH.html">SSH</a>
            protocol.</p>
            
            <pre class="ruby"><span class="ruby-identifier">ssh</span>.<span class="ruby-identifier">open_channel</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">channel</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">exec</span>(<span class="ruby-string">&quot;/invoke/some/command&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">success</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">abort</span> <span class="ruby-string">&quot;could not execute command&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">success</span>&#x000A;&#x000A;    <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_data</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;got stdout: #{data}&quot;</span>&#x000A;      <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">send_data</span> <span class="ruby-string">&quot;something for stdin\n&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_extended_data</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;got stderr: #{data}&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_close</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;channel is closing!&quot;</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-identifier">ssh</span>.<span class="ruby-identifier">loop</span></pre>
            
            <p>Channels also have a basic hash-like interface, that allows programs to
            store arbitrary state information on a channel object. This helps simplify
            the writing of state machines, especially when you may be juggling multiple
            open channels at the same time.</p>
            
            <p>Note that data sent across <a href="../../SSH.html">SSH</a> channels are
            governed by maximum packet sizes and maximum window sizes. These details
            are managed internally by <a
            href="Channel.html">Net::SSH::Connection::Channel</a>, so you may remain
            blissfully ignorant if you so desire, but you can always inspect the
            current maximums, as well as the remaining window size, using the reader
            attributes for those values.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a target="docwin" href="#method-c-new">new</a></li>
            </ol>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-5B-5D">[]</a></li>
              <li><a target="docwin" href="#method-i-5B-5D-3D">[]=</a></li>
              <li><a target="docwin" href="#method-i-active-3F">active?</a></li>
              <li><a target="docwin" href="#method-i-close">close</a></li>
              <li><a target="docwin" href="#method-i-closing-3F">closing?</a></li>
              <li><a target="docwin" href="#attribute-i-connection">connection</a></li>
              <li><a target="docwin" href="#method-i-do_close">do_close</a></li>
              <li><a target="docwin" href="#method-i-do_eof">do_eof</a></li>
              <li><a target="docwin" href="#method-i-do_extended_data">do_extended_data</a></li>
              <li><a target="docwin" href="#method-i-do_failure">do_failure</a></li>
              <li><a target="docwin" href="#method-i-do_open_failed">do_open_failed</a></li>
              <li><a target="docwin" href="#method-i-do_success">do_success</a></li>
              <li><a target="docwin" href="#method-i-env">env</a></li>
              <li><a target="docwin" href="#method-i-eof-21">eof!</a></li>
              <li><a target="docwin" href="#method-i-eof-3F">eof?</a></li>
              <li><a target="docwin" href="#method-i-exec">exec</a></li>
              <li><a target="docwin" href="#attribute-i-local_id">local_id</a></li>
              <li><a target="docwin" href="#attribute-i-local_maximum_packet_size">local_maximum_packet_size</a></li>
              <li><a target="docwin" href="#attribute-i-local_maximum_window_size">local_maximum_window_size</a></li>
              <li><a target="docwin" href="#attribute-i-local_window_size">local_window_size</a></li>
              <li><a target="docwin" href="#method-i-on_close">on_close</a></li>
              <li><a target="docwin" href="#method-i-on_data">on_data</a></li>
              <li><a target="docwin" href="#method-i-on_eof">on_eof</a></li>
              <li><a target="docwin" href="#method-i-on_extended_data">on_extended_data</a></li>
              <li><a target="docwin" href="#method-i-on_open_failed">on_open_failed</a></li>
              <li><a target="docwin" href="#method-i-on_process">on_process</a></li>
              <li><a target="docwin" href="#method-i-on_request">on_request</a></li>
              <li><a target="docwin" href="#method-i-process">process</a></li>
              <li><a target="docwin" href="#attribute-i-properties">properties</a></li>
              <li><a target="docwin" href="#attribute-i-remote_id">remote_id</a></li>
              <li><a target="docwin" href="#attribute-i-remote_maximum_packet_size">remote_maximum_packet_size</a></li>
              <li><a target="docwin" href="#attribute-i-remote_maximum_window_size">remote_maximum_window_size</a></li>
              <li><a target="docwin" href="#attribute-i-remote_window_size">remote_window_size</a></li>
              <li><a target="docwin" href="#method-i-request_pty">request_pty</a></li>
              <li><a target="docwin" href="#method-i-send_channel_request">send_channel_request</a></li>
              <li><a target="docwin" href="#method-i-send_data">send_data</a></li>
              <li><a target="docwin" href="#method-i-subsystem">subsystem</a></li>
              <li><a target="docwin" href="#attribute-i-type">type</a></li>
              <li><a target="docwin" href="#method-i-wait">wait</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li><a target="docwin" href="Constants.html">Constants</a></li>
                <li><a target="docwin" href="../Loggable.html">Loggable</a></li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>VALID_PTY_OPTIONS</td>
                    <td>=</td>
                    <td class='context-item-value'>
                      { :term        => "xterm",
                      :chars_wide  => 80,
                      :chars_high  => 24,
                      :pixels_wide => 640,
                      :pixels_high => 480,
                      :modes       => {} }
                    </td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>A hash of the valid PTY options (see <a
                      href="Channel.html#method-i-request_pty">request_pty</a>).</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-connection'>connection</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The underlying <a href="Session.html">Net::SSH::Connection::Session</a>
                      instance that supports this channel.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-local_id'>local_id</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The local id for this channel, assigned by the <a
                      href="Session.html">Net::SSH::Connection::Session</a> instance.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-local_maximum_packet_size'>local_maximum_packet_size</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The maximum packet size that the local host can receive.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-local_maximum_window_size'>local_maximum_window_size</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The maximum amount of data that the local end of this channel can receive.
                      This is a total, not per-packet.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-local_window_size'>local_window_size</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>This is the remaining window size on the local end of this channel. When
                      this reaches zero, no more data can be received.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-properties'>properties</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>A hash of properties for this channel. These can be used to store state
                      information about this channel. See also #[] and #[]=.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-remote_id'>remote_id</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The remote id for this channel, assigned by the remote host.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-remote_maximum_packet_size'>remote_maximum_packet_size</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The maximum packet size that the remote host can receive.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-remote_maximum_window_size'>remote_maximum_window_size</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The maximum amount of data that the remote end of this channel can receive.
                      This is a total, not per-packet.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-remote_window_size'>remote_window_size</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>This is the remaining window size on the remote end of this channel. When
                      this reaches zero, no more data can be sent.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-type'>type</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The type of this channel, usually "session".</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-new'>
                <a name='method-c-new'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(connection, type, local_id, max_pkt_size = 0x8000, max_win_size = 0x20000, &on_confirm_open)</span>
                </div>
                <div class='description'>
                  
                  <p>Instantiates a new channel on the given connection, of the given type, and
                  with the given id. If a block is given, it will be remembered until the
                  channel is confirmed open by the server, and will be invoked at that time
                  (see do_open_confirmation).</p>
                  
                  <p>This also sets the default maximum packet size and maximum window size.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-new-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-new-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 110</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">local_id</span>, <span class="ruby-identifier">max_pkt_size</span> = <span class="ruby-value">0x8000</span>, <span class="ruby-identifier">max_win_size</span> = <span class="ruby-value">0x20000</span>, &amp;<span class="ruby-identifier">on_confirm_open</span>)&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">logger</span>&#x000A;&#x000A;  <span class="ruby-ivar">@connection</span> = <span class="ruby-identifier">connection</span>&#x000A;  <span class="ruby-ivar">@type</span>       = <span class="ruby-identifier">type</span>&#x000A;  <span class="ruby-ivar">@local_id</span>   = <span class="ruby-identifier">local_id</span>&#x000A;&#x000A;  <span class="ruby-ivar">@local_maximum_packet_size</span> = <span class="ruby-identifier">max_pkt_size</span>&#x000A;  <span class="ruby-ivar">@local_window_size</span> = <span class="ruby-ivar">@local_maximum_window_size</span> = <span class="ruby-identifier">max_win_size</span>&#x000A;&#x000A;  <span class="ruby-ivar">@on_confirm_open</span> = <span class="ruby-identifier">on_confirm_open</span>&#x000A;&#x000A;  <span class="ruby-ivar">@output</span> = <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>&#x000A;&#x000A;  <span class="ruby-ivar">@properties</span> = {}&#x000A;&#x000A;  <span class="ruby-ivar">@pending_requests</span> = []&#x000A;  <span class="ruby-ivar">@on_open_failed</span> = <span class="ruby-ivar">@on_data</span> = <span class="ruby-ivar">@on_extended_data</span> = <span class="ruby-ivar">@on_process</span> = <span class="ruby-ivar">@on_close</span> = <span class="ruby-ivar">@on_eof</span> = <span class="ruby-keyword">nil</span>&#x000A;  <span class="ruby-ivar">@on_request</span> = {}&#x000A;  <span class="ruby-ivar">@closing</span> = <span class="ruby-ivar">@eof</span> = <span class="ruby-ivar">@sent_eof</span> = <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-5B-5D'>
                <a name='method-i-5B-5D'></a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='description'>
                  
                  <p>A shortcut for accessing properties of the channel (see <a
                  href="Channel.html#attribute-i-properties">properties</a>).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-5B-5D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-5B-5D-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 133</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-5B-5D-3D'>
                <a name='method-i-5B-5D-3D'></a>
                <div class='synopsis'>
                  <span class='name'>[]=</span>
                  <span class='arguments'>(name, value)</span>
                </div>
                <div class='description'>
                  
                  <p>A shortcut for setting properties of the channel (see <a
                  href="Channel.html#attribute-i-properties">properties</a>).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-5B-5D-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-5B-5D-3D-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 138</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)&#x000A;  <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">value</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-active-3F'>
                <a name='method-i-active-3F'></a>
                <div class='synopsis'>
                  <span class='name'>active?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if the channel exists in the channel list of the session, and
                  false otherwise. This can be used to determine whether a channel has been
                  closed or not.</p>
                  
                  <pre>ssh.loop { channel.active? }</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-active-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-active-3F-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 259</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">active?</span>&#x000A;  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">local_id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-close'>
                <a name='method-i-close'></a>
                <div class='synopsis'>
                  <span class='name'>close</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Requests that the channel be closed. If the channel is already closing,
                  this does nothing, nor does it do anything if the channel has not yet been
                  confirmed open (see do_open_confirmation). Otherwise, it sends a
                  CHANNEL_CLOSE message and marks the channel as closing.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-close-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-close-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 284</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">close</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@closing</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">remote_id</span>&#x000A;    <span class="ruby-ivar">@closing</span> = <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">send_message</span>(<span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">:byte</span>, <span class="ruby-constant">CHANNEL_CLOSE</span>, <span class="ruby-value">:long</span>, <span class="ruby-identifier">remote_id</span>))&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-closing-3F'>
                <a name='method-i-closing-3F'></a>
                <div class='synopsis'>
                  <span class='name'>closing?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if the channel is currently closing, but not actually closed.
                  A channel is closing when, for instance, <a
                  href="Channel.html#method-i-close">close</a> has been invoked, but the
                  server has not yet responded with a CHANNEL_CLOSE packet of its own.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-closing-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-closing-3F-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 276</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">closing?</span>&#x000A;  <span class="ruby-ivar">@closing</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-do_close'>
                <a name='method-i-do_close'></a>
                <div class='synopsis'>
                  <span class='name'>do_close</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Invokes the <a href="Channel.html#method-i-on_close">on_close</a> callback
                  when the server closes a channel. The channel is the only argument.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_close-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_close-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 590</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_close</span>&#x000A;  <span class="ruby-ivar">@on_close</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@on_close</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-do_eof'>
                <a name='method-i-do_eof'></a>
                <div class='synopsis'>
                  <span class='name'>do_eof</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Invokes the <a href="Channel.html#method-i-on_eof">on_eof</a> callback when
                  the server indicates that no further data is forthcoming. The callback is
                  invoked with the channel as the argument.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_eof-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_eof-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 584</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_eof</span>&#x000A;  <span class="ruby-ivar">@on_eof</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@on_eof</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-do_extended_data'>
                <a name='method-i-do_extended_data'></a>
                <div class='synopsis'>
                  <span class='name'>do_extended_data</span>
                  <span class='arguments'>(type, data)</span>
                </div>
                <div class='description'>
                  
                  <p>Invokes the <a
                  href="Channel.html#method-i-on_extended_data">on_extended_data</a> callback
                  when the server sends extended data to the channel. This will reduce the
                  available window size on the local end. The callback is invoked with the
                  channel, type, and data.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_extended_data-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_extended_data-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 576</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_extended_data</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>)&#x000A;  <span class="ruby-identifier">update_local_window_size</span>(<span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>)&#x000A;  <span class="ruby-ivar">@on_extended_data</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@on_extended_data</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-do_failure'>
                <a name='method-i-do_failure'></a>
                <div class='synopsis'>
                  <span class='name'>do_failure</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Invokes the next pending request callback with <code>false</code> as the
                  second argument.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_failure-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_failure-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 596</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_failure</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">pending_requests</span>.<span class="ruby-identifier">shift</span>&#x000A;    <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>, <span class="ruby-keyword">false</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">error</span> { <span class="ruby-string">&quot;channel failure recieved with no pending request to handle it (bug?)&quot;</span> }&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-do_open_failed'>
                <a name='method-i-do_open_failed'></a>
                <div class='synopsis'>
                  <span class='name'>do_open_failed</span>
                  <span class='arguments'>(reason_code, description)</span>
                </div>
                <div class='description'>
                  
                  <p>Invoked when the server failed to open the channel. If an <a
                  href="Channel.html#method-i-on_open_failed">on_open_failed</a> callback was
                  specified, it will be invoked with the channel, reason code, and
                  description as arguments. Otherwise, a <a
                  href="../ChannelOpenFailed.html">ChannelOpenFailed</a> exception will be
                  raised.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_open_failed-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_open_failed-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 521</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_open_failed</span>(<span class="ruby-identifier">reason_code</span>, <span class="ruby-identifier">description</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@on_open_failed</span>&#x000A;    <span class="ruby-ivar">@on_open_failed</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">reason_code</span>, <span class="ruby-identifier">description</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ChannelOpenFailed</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">reason_code</span>, <span class="ruby-identifier">description</span>)&#x000A;  <span class="ruby-keyword">end</span>          &#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-do_success'>
                <a name='method-i-do_success'></a>
                <div class='synopsis'>
                  <span class='name'>do_success</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Invokes the next pending request callback with <code>true</code> as the
                  second argument.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_success-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_success-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 606</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_success</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">pending_requests</span>.<span class="ruby-identifier">shift</span>&#x000A;    <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>, <span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">error</span> { <span class="ruby-string">&quot;channel success recieved with no pending request to handle it (bug?)&quot;</span> }&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-env'>
                <a name='method-i-env'></a>
                <div class='synopsis'>
                  <span class='name'>env</span>
                  <span class='arguments'>(variable_name, variable_value, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Syntactic sugar for setting an environment variable in the remote process'
                  environment. Note that for security reasons, the server may refuse to set
                  certain environment variables, or all, at the server's discretion. If you
                  are connecting to an OpenSSH server, you will need to update the AcceptEnv
                  setting in the sshd_config to include the environment variables you want to
                  send.</p>
                  
                  <pre>channel.env &quot;PATH&quot;, &quot;/usr/local/bin&quot;</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-env-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-env-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 187</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">env</span>(<span class="ruby-identifier">variable_name</span>, <span class="ruby-identifier">variable_value</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-string">&quot;env&quot;</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">variable_name</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">variable_value</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-eof-21'>
                <a name='method-i-eof-21'></a>
                <div class='synopsis'>
                  <span class='name'>eof!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Tells the remote end of the channel that no more data is forthcoming from
                  this end of the channel. The remote end may still send data. The
                  CHANNEL_EOF packet will be sent once the output buffer is empty.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-eof-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-eof-21-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 302</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">eof!</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">eof?</span>&#x000A;  <span class="ruby-ivar">@eof</span> = <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-eof-3F'>
                <a name='method-i-eof-3F'></a>
                <div class='synopsis'>
                  <span class='name'>eof?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if the local end of the channel has declared that no more data
                  is forthcoming (see <a href="Channel.html#method-i-eof-21">eof!</a>).
                  Trying to send data via <a
                  href="Channel.html#method-i-send_data">send_data</a> when this is true will
                  result in an exception being raised.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-eof-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-eof-3F-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 295</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">eof?</span>&#x000A;  <span class="ruby-ivar">@eof</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-exec'>
                <a name='method-i-exec'></a>
                <div class='synopsis'>
                  <span class='name'>exec</span>
                  <span class='arguments'>(command, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Syntactic sugar for executing a command. Sends a channel request asking
                  that the given command be invoked. If the block is given, it will be called
                  when the server responds. The first parameter will be the channel, and the
                  second will be true or false, indicating whether the request succeeded or
                  not. In this case, success means that the command is being executed, not
                  that it has completed, and failure means that the command altogether failed
                  to be executed.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">exec</span> <span class="ruby-string">&quot;ls -l /home&quot;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">success</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">success</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;command has begun executing...&quot;</span>&#x000A;    <span class="ruby-comment"># this is a good place to hang callbacks like #on_data...</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;alas! the command could not be invoked!&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-exec-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-exec-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 158</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">exec</span>(<span class="ruby-identifier">command</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-string">&quot;exec&quot;</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">command</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on_close'>
                <a name='method-i-on_close'></a>
                <div class='synopsis'>
                  <span class='name'>on_close</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Registers a callback to be invoked when the server acknowledges that a
                  channel is closed. This is invoked with the channel as the sole argument.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_close</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;remote end is closing!&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on_close-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on_close-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 383</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on_close</span>(&amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_close</span> = <span class="ruby-ivar">@on_close</span>, <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">old</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on_data'>
                <a name='method-i-on_data'></a>
                <div class='synopsis'>
                  <span class='name'>on_data</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Registers a callback to be invoked when data packets are received by the
                  channel. The callback is called with the channel as the first argument, and
                  the data as the second.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_data</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;got data: #{data.inspect}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Data received this way is typically the data written by the remote process
                  to its <code>stdout</code> stream.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on_data-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on_data-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 330</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on_data</span>(&amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_data</span> = <span class="ruby-ivar">@on_data</span>, <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">old</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on_eof'>
                <a name='method-i-on_eof'></a>
                <div class='synopsis'>
                  <span class='name'>on_eof</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Registers a callback to be invoked when the server indicates that no more
                  data will be sent to the channel (although the channel can still send data
                  to the server). The channel is the sole argument to the callback.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_eof</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;remote end is done sending data&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on_eof-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on_eof-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 395</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on_eof</span>(&amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_eof</span> = <span class="ruby-ivar">@on_eof</span>, <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">old</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on_extended_data'>
                <a name='method-i-on_extended_data'></a>
                <div class='synopsis'>
                  <span class='name'>on_extended_data</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Registers a callback to be invoked when extended data packets are received
                  by the channel. The callback is called with the channel as the first
                  argument, the data type (as an integer) as the second, and the data as the
                  third. Extended data is almost exclusively used to send <code>stderr</code>
                  data (<code>type</code> == 1). Other extended data types are not defined by
                  the <a href="../../SSH.html">SSH</a> protocol.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_extended_data</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;got stderr: #{data.inspect}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on_extended_data-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on_extended_data-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 345</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on_extended_data</span>(&amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_extended_data</span> = <span class="ruby-ivar">@on_extended_data</span>, <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">old</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on_open_failed'>
                <a name='method-i-on_open_failed'></a>
                <div class='synopsis'>
                  <span class='name'>on_open_failed</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Registers a callback to be invoked when the server was unable to open the
                  requested channel. The channel itself will be passed to the block, along
                  with the integer "reason code" for the failure, and a textual description
                  of the failure from the server.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span> = <span class="ruby-identifier">session</span>.<span class="ruby-identifier">open_channel</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-comment"># ..</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_open_failed</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">code</span>, <span class="ruby-identifier">desc</span><span class="ruby-operator">|</span> <span class="ruby-operator">...</span> }</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on_open_failed-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on_open_failed-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 410</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on_open_failed</span>(&amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_open_failed</span> = <span class="ruby-ivar">@on_open_failed</span>, <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">old</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on_process'>
                <a name='method-i-on_process'></a>
                <div class='synopsis'>
                  <span class='name'>on_process</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Registers a callback to be invoked for each pass of the event loop for this
                  channel. There are no guarantees on timeliness in the event loop, but it
                  will be called roughly once for each packet received by the connection (not
                  the channel). This callback is invoked with the channel as the sole
                  argument.</p>
                  
                  <p>Here's an example that accumulates the channel data into a variable on the
                  channel itself, and displays individual lines in the input one at a time
                  when the channel is processed:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>[:<span class="ruby-identifier">data</span>] = <span class="ruby-string">&quot;&quot;</span>&#x000A;&#x000A;<span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_data</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">channel</span>[:<span class="ruby-identifier">data</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">data</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_process</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">channel</span>[:<span class="ruby-identifier">data</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r^.*?\n/</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-node">$&amp;</span>&#x000A;    <span class="ruby-identifier">channel</span>[:<span class="ruby-identifier">data</span>] = <span class="ruby-node">$'</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on_process-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on_process-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 372</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on_process</span>(&amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_process</span> = <span class="ruby-ivar">@on_process</span>, <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">old</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on_request'>
                <a name='method-i-on_request'></a>
                <div class='synopsis'>
                  <span class='name'>on_request</span>
                  <span class='arguments'>(type, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Registers a callback to be invoked when a channel request of the given type
                  is received. The callback will receive the channel as the first argument,
                  and the associated (unparsed) data as the second. The data will be a <a
                  href="../Buffer.html">Net::SSH::Buffer</a> that you will need to parse,
                  yourself, according to the kind of request you are watching.</p>
                  
                  <p>By default, if the request wants a reply, <a
                  href="../../SSH.html">Net::SSH</a> will send a CHANNEL_SUCCESS response for
                  any request that was handled by a registered callback, and CHANNEL_FAILURE
                  for any that wasn't, but if you want your registered callback to result in
                  a CHANNEL_FAILURE response, just raise <a
                  href="../ChannelRequestFailed.html">Net::SSH::ChannelRequestFailed</a>.</p>
                  
                  <p>Some common channel requests that your programs might want to listen for
                  are:</p>
                  <ul><li>
                  <p>"exit-status" : the exit status of the remote process will be reported as a
                  long integer in the data buffer, which you can grab via data.read_long.</p>
                  </li><li>
                  <p>"exit-signal" : if the remote process died as a result of a signal being
                  sent to it, the signal will be reported as a string in the data, via
                  data.read_string. (Not all <a href="../../SSH.html">SSH</a> servers support
                  this channel request type.)</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_request</span> <span class="ruby-string">&quot;exit-status&quot;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;process terminated with exit status: #{data.read_long}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on_request-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on_request-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 441</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on_request</span>(<span class="ruby-identifier">type</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_request</span>[<span class="ruby-identifier">type</span>] = <span class="ruby-ivar">@on_request</span>[<span class="ruby-identifier">type</span>], <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-identifier">old</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-process'>
                <a name='method-i-process'></a>
                <div class='synopsis'>
                  <span class='name'>process</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>If an <a href="Channel.html#method-i-on_process">on_process</a> handler has
                  been set up, this will cause it to be invoked (passing the channel itself
                  as an argument). It also causes all pending output to be enqueued as
                  CHANNEL_DATA packets (see enqueue_pending_output).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-process-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-process-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 310</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">process</span>&#x000A;  <span class="ruby-ivar">@on_process</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@on_process</span>&#x000A;  <span class="ruby-identifier">enqueue_pending_output</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@eof</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-ivar">@sent_eof</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">output</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">remote_id</span>&#x000A;    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">send_message</span>(<span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">:byte</span>, <span class="ruby-constant">CHANNEL_EOF</span>, <span class="ruby-value">:long</span>, <span class="ruby-identifier">remote_id</span>))&#x000A;    <span class="ruby-ivar">@sent_eof</span> = <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-request_pty'>
                <a name='method-i-request_pty'></a>
                <div class='synopsis'>
                  <span class='name'>request_pty</span>
                  <span class='arguments'>(opts={}, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Requests that a pseudo-tty (or "pty") be made available for this channel.
                  This is useful when you want to invoke and interact with some kind of
                  screen-based program (e.g., vim, or some menuing system).</p>
                  
                  <p>Note, that without a pty some programs (e.g. sudo, or subversion) on some
                  systems, will not be able to run interactively, and will error instead of
                  prompt if they ever need some user interaction.</p>
                  
                  <p>Note, too, that when a pty is requested, user's shell configuration scripts
                  (.bashrc and such) are not run by default, whereas they are run when a pty
                  is not present.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">request_pty</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">success</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">success</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;pty successfully obtained&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;could not obtain pty&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-request_pty-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-request_pty-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 218</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">request_pty</span>(<span class="ruby-identifier">opts</span>={}, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">extra</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">-</span> <span class="ruby-constant">VALID_PTY_OPTIONS</span>.<span class="ruby-identifier">keys</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;invalid option(s) to request_pty: #{extra.inspect}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">extra</span>.<span class="ruby-identifier">any?</span>&#x000A;&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-constant">VALID_PTY_OPTIONS</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)&#x000A;&#x000A;  <span class="ruby-identifier">modes</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:modes</span>].<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">memo</span>, (<span class="ruby-identifier">mode</span>, <span class="ruby-identifier">data</span>)<span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">memo</span>.<span class="ruby-identifier">write_byte</span>(<span class="ruby-identifier">mode</span>).<span class="ruby-identifier">write_long</span>(<span class="ruby-identifier">data</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-comment"># mark the end of the mode opcode list with a 0 byte</span>&#x000A;  <span class="ruby-identifier">modes</span>.<span class="ruby-identifier">write_byte</span>(<span class="ruby-value">0</span>)&#x000A;&#x000A;  <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-string">&quot;pty-req&quot;</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:term</span>],&#x000A;    <span class="ruby-value">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:chars_wide</span>], <span class="ruby-value">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:chars_high</span>],&#x000A;    <span class="ruby-value">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:pixels_wide</span>], <span class="ruby-value">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:pixels_high</span>],&#x000A;    <span class="ruby-value">:string</span>, <span class="ruby-identifier">modes</span>.<span class="ruby-identifier">to_s</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-send_channel_request'>
                <a name='method-i-send_channel_request'></a>
                <div class='synopsis'>
                  <span class='name'>send_channel_request</span>
                  <span class='arguments'>(request_name, *data, &callback)</span>
                </div>
                <div class='description'>
                  
                  <p>Sends a new channel request with the given name. The extra
                  <code>data</code> parameter must either be empty, or consist of an even
                  number of arguments. See <a
                  href="../Buffer.html#method-c-from">Net::SSH::Buffer.from</a> for a
                  description of their format. If a block is given, it is registered as a
                  callback for a pending request, and the packet will be flagged so that the
                  server knows a reply is required. If no block is given, the server will
                  send no response to this request. Responses, where required, will cause the
                  callback to be invoked with the channel as the first argument, and either
                  true or false as the second, depending on whether the request succeeded or
                  not. The meaning of "success" and "failure" in this context is dependent on
                  the specific request that was sent.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">send_channel_request</span> <span class="ruby-string">&quot;shell&quot;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">success</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">success</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;user shell started successfully&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;could not start user shell&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Most channel requests you'll want to send are already wrapped in more
                  convenient helper methods (see <a
                  href="Channel.html#method-i-exec">exec</a> and <a
                  href="Channel.html#method-i-subsystem">subsystem</a>).</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-send_channel_request-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-send_channel_request-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 468</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-identifier">request_name</span>, *<span class="ruby-identifier">data</span>, &amp;<span class="ruby-identifier">callback</span>)&#x000A;  <span class="ruby-identifier">info</span> { <span class="ruby-node">&quot;sending channel request #{request_name.inspect}&quot;</span> }&#x000A;  <span class="ruby-identifier">msg</span> = <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">:byte</span>, <span class="ruby-constant">CHANNEL_REQUEST</span>,&#x000A;    <span class="ruby-value">:long</span>, <span class="ruby-identifier">remote_id</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">request_name</span>,&#x000A;    <span class="ruby-value">:bool</span>, <span class="ruby-operator">!</span><span class="ruby-identifier">callback</span>.<span class="ruby-identifier">nil?</span>, *<span class="ruby-identifier">data</span>)&#x000A;  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">send_message</span>(<span class="ruby-identifier">msg</span>)&#x000A;  <span class="ruby-identifier">pending_requests</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">callback</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">callback</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-send_data'>
                <a name='method-i-send_data'></a>
                <div class='synopsis'>
                  <span class='name'>send_data</span>
                  <span class='arguments'>(data)</span>
                </div>
                <div class='description'>
                  
                  <p>Sends data to the channel's remote endpoint. This usually has the effect of
                  sending the given string to the remote process' stdin stream. Note that it
                  does not immediately send the data across the channel, but instead merely
                  appends the given data to the channel's output buffer, preparatory to being
                  packaged up and sent out the next time the connection is accepting data. (A
                  connection might not be accepting data if, for instance, it has filled its
                  data window and has not yet been resized by the remote end-point.)</p>
                  
                  <p>This will raise an exception if the channel has previously declared that no
                  more data will be sent (see <a
                  href="Channel.html#method-i-eof-21">eof!</a>).</p>
                  
                  <pre>channel.send_data(&quot;the password\n&quot;)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-send_data-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-send_data-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 249</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_data</span>(<span class="ruby-identifier">data</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span>, <span class="ruby-string">&quot;cannot send data if channel has declared eof&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">eof?</span>&#x000A;  <span class="ruby-identifier">output</span>.<span class="ruby-identifier">append</span>(<span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-subsystem'>
                <a name='method-i-subsystem'></a>
                <div class='synopsis'>
                  <span class='name'>subsystem</span>
                  <span class='arguments'>(subsystem, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Syntactic sugar for requesting that a subsystem be started. Subsystems are
                  a way for other protocols (like SFTP) to be run, using <a
                  href="../../SSH.html">SSH</a> as the transport. Generally, you'll never
                  need to call this directly unless you are the implementor of something that
                  consumes an <a href="../../SSH.html">SSH</a> subsystem, like SFTP.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">channel</span>.<span class="ruby-identifier">subsystem</span>(<span class="ruby-string">&quot;sftp&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">success</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">success</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;subsystem successfully started&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;subsystem could not be started&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-subsystem-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-subsystem-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 175</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">subsystem</span>(<span class="ruby-identifier">subsystem</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-string">&quot;subsystem&quot;</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">subsystem</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-wait'>
                <a name='method-i-wait'></a>
                <div class='synopsis'>
                  <span class='name'>wait</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Runs the <a href="../../SSH.html">SSH</a> event loop until the channel is
                  no longer active. This is handy for blocking while you wait for some
                  channel to finish.</p>
                  
                  <pre>channel.exec(&quot;grep ...&quot;) { ... }&#x000A;channel.wait</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-wait-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-wait-source'><span class="ruby-comment"># File lib/net/ssh/connection/channel.rb, line 268</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">wait</span>&#x000A;  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">loop</span> { <span class="ruby-identifier">active?</span> }&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
