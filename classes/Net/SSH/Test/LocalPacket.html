<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Net::SSH::Test::LocalPacket</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          Net::SSH::Test::LocalPacket
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../../../files/lib/net/ssh/test/local_packet_rb.html">lib/net/ssh/test/local_packet.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Test.html">Test</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>This is a specialization of <a
            href="Packet.html">Net::SSH::Test::Packet</a> for representing mock packets
            that are sent from the local (client) host. These are created automatically
            by <a href="Script.html">Net::SSH::Test::Script</a> and <a
            href="Channel.html">Net::SSH::Test::Channel</a> by any of the sends_*
            methods.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a target="docwin" href="#method-c-new">new</a></li>
            </ol>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#attribute-i-init">init</a></li>
              <li><a target="docwin" href="#method-i-local-3F">local?</a></li>
              <li><a target="docwin" href="#method-i-process">process</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-init'>init</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-new'>
                <a name='method-c-new'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(type, *args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Extend the default <a href="Packet.html">Net::SSH::Test::Packet</a>
                  constructor to also accept an optional block, which is used to finalize the
                  initialization of the packet when #<a
                  href="LocalPacket.html#method-i-process">#process</a> is first called.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-new-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-new-source'><span class="ruby-comment"># File lib/net/ssh/test/local_packet.rb, line 16</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">type</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">super</span>(<span class="ruby-identifier">type</span>, *<span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-ivar">@init</span> = <span class="ruby-identifier">block</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-local-3F'>
                <a name='method-i-local-3F'></a>
                <div class='synopsis'>
                  <span class='name'>local?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns <code>true</code>; this is a local packet.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-local-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-local-3F-source'><span class="ruby-comment"># File lib/net/ssh/test/local_packet.rb, line 22</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">local?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-process'>
                <a name='method-i-process'></a>
                <div class='synopsis'>
                  <span class='name'>process</span>
                  <span class='arguments'>(packet)</span>
                </div>
                <div class='description'>
                  
                  <p>Called by <a
                  href="Extensions/PacketStream.html#method-i-test_enqueue_packet">Net::SSH::Test::Extensions::PacketStream#test_enqueue_packet</a>
                  to mimic remote processing of a locally-sent packet. It compares the packet
                  it was given with the contents of this LocalPacket's data, to see if what
                  was sent matches what was scripted. If it differs in any way, an exception
                  is raised.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-process-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-process-source'><span class="ruby-comment"># File lib/net/ssh/test/local_packet.rb, line 31</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">process</span>(<span class="ruby-identifier">packet</span>)&#x000A;  <span class="ruby-ivar">@init</span>.<span class="ruby-identifier">call</span>(<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Packet</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">packet</span>.<span class="ruby-identifier">to_s</span>)) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@init</span>&#x000A;  <span class="ruby-identifier">type</span> = <span class="ruby-identifier">packet</span>.<span class="ruby-identifier">read_byte</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;expected #{@type}, but got #{type}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@type</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">type</span>&#x000A;&#x000A;  <span class="ruby-ivar">@data</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">types</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">expected</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">type</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">case</span> <span class="ruby-identifier">expected</span>&#x000A;      <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">then</span> <span class="ruby-keyword">break</span>&#x000A;      <span class="ruby-keyword">when</span> <span class="ruby-constant">Numeric</span> <span class="ruby-keyword">then</span> <span class="ruby-value">:long</span>&#x000A;      <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span> <span class="ruby-keyword">then</span> <span class="ruby-value">:string</span>&#x000A;      <span class="ruby-keyword">when</span> <span class="ruby-constant">TrueClass</span>, <span class="ruby-constant">FalseClass</span> <span class="ruby-keyword">then</span> <span class="ruby-value">:bool</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">actual</span> = <span class="ruby-identifier">packet</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;read_#{type}&quot;</span>)&#x000A;    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;expected #{type} #{expected.inspect} but got #{actual.inspect}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">expected</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">actual</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
